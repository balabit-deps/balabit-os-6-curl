Backport of:

From 92acf6a2df83285a397919506a0a45a638564b9c Mon Sep 17 00:00:00 2001
From: Daniel Stenberg <daniel@haxx.se>
Date: Fri, 28 Sep 2018 16:08:16 +0200
Subject: [PATCH] Curl_auth_create_plain_message: fix too-large-input-check

Reported-by: Harry Sintonen
---
 lib/vauth/cleartext.c | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

Index: curl-7.47.0/lib/curl_sasl.c
===================================================================
--- curl-7.47.0.orig/lib/curl_sasl.c	2018-10-24 08:37:39.816087440 -0400
+++ curl-7.47.0/lib/curl_sasl.c	2018-10-24 08:37:39.812087439 -0400
@@ -315,7 +315,7 @@ static CURLcode sasl_create_plain_messag
   plen = strlen(passwdp);
 
   /* Compute binary message length. Check for overflows. */
-  if((ulen > SIZE_T_MAX/2) || (plen > (SIZE_T_MAX/2 - 2)))
+  if((ulen > SIZE_T_MAX/4) || (plen > (SIZE_T_MAX/2 - 2)))
     return CURLE_OUT_OF_MEMORY;
   plainlen = 2 * ulen + plen + 2;
 
