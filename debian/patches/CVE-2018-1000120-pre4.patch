From f81a8364618caf99b4691ffd494a9b2d4c9fb1f6 Mon Sep 17 00:00:00 2001
From: Daniel Stenberg <daniel@haxx.se>
Date: Wed, 2 Nov 2016 07:22:27 +0100
Subject: [PATCH] ftp_done: don't clobber the passed in error code

Coverity CID 1374359 pointed out the unused result value.
---
 lib/ftp.c | 9 +++++----
 1 file changed, 5 insertions(+), 4 deletions(-)

Index: curl-7.47.0/lib/ftp.c
===================================================================
--- curl-7.47.0.orig/lib/ftp.c	2018-03-14 09:11:02.952998355 -0400
+++ curl-7.47.0/lib/ftp.c	2018-03-14 09:11:02.952998355 -0400
@@ -3297,11 +3297,12 @@ static CURLcode ftp_done(struct connectd
     ftpc->known_filesize = -1;
   }
 
-  /* get the "raw" path */
-  result = Curl_urldecode(data, path_to_use, 0, &path, NULL, FALSE);
+  if(!result)
+    /* get the "raw" path */
+    result = Curl_urldecode(data, path_to_use, 0, &path, NULL, FALSE);
   if(result) {
-    /* out of memory, but we can limp along anyway (and should try to
-     * since we may already be in the out of memory cleanup path) */
+    /* We can limp along anyway (and should try to since we may already be in
+     * the error path) */
     ftpc->ctl_valid = FALSE; /* mark control connection as bad */
     connclose(conn, "FTP: out of memory!"); /* mark for connection closure */
     ftpc->prevpath = NULL; /* no path remembering */
